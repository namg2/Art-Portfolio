<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Watched Movies</title>

  <link href="https://fonts.googleapis.com/css2?family=Delius&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="movies.css">
</head>

<body>
  <header>
    <h1>Movie List</h1>
    <p id="total-movies"></p>
  </header>

  <nav>
    <a href="index.html">home</a>
    <a href="gallery.html">gallery</a>
    <a href="movies.html">movies</a>
    <a href="books.html">books</a>
    <a href="crochets.html">crochets</a>
    <a href="contact.html">contact</a>
  </nav>

  <div id="movie-root"></div>

  <footer>
    <p>@nicolemartinez 2025</p>
  </footer>

  <script>
    fetch('movies.json')
      .then(res => res.json())
      .then(data => {
        const root = document.getElementById('movie-root');
        const totalText = document.getElementById('total-movies');
        const grouped = {};

        totalText.textContent = `${data.length} movies watched total`;

        data.forEach(movie => {
          const year = movie.year_watched || 'Unknown';
          if (!grouped[year]) grouped[year] = [];
          grouped[year].push(movie);
        });

        Object.keys(grouped)
          .sort((a, b) => b - a)
          .forEach(year => {
            const section = document.createElement('section');
            section.innerHTML = `
              <div class="year-divider">
                Watched in ${year}
                <small>♡ ${grouped[year].length} movies</small>
              </div>
            `;

            const container = document.createElement('div');
            container.className = 'movie-container';

            grouped[year].forEach((movie, index) => {
              const card = document.createElement('div');
              card.className = 'movie-card';

              card.innerHTML = `
                <img src="${movie.image || 'https://via.placeholder.com/250x370?text=No+Image'}" alt="${movie.title}">
                <h3>${index + 1}. ${movie.title}</h3>

                <p><strong>Watched:</strong> ${movie.year_watched || '—'}</p>
                <p><strong>Released:</strong> ${movie.release_date || '—'}</p>
                <p><strong>Rating:</strong> ${movie.rating !== null ? movie.rating + '/10' : '—'}</p>

                ${movie.description ? `<p class="description">${movie.description}</p>` : ''}
                ${movie.note ? `<p class="movie-note"><strong>Note:</strong> ${movie.note}</p>` : ''}
              `;

              container.appendChild(card);
            });

            section.appendChild(container);
            root.appendChild(section);
          });
      })
      .catch(err => console.error('Error loading movies:', err));
  </script>
</body>
</html>
